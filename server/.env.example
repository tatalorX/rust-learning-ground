# Rust Learning Ground - Environment Configuration Template
#
# SECURITY WARNING: Never commit this file with real values to git!
# Copy this file to .env and fill in your actual values.
#
# For production deployment with sops/age encryption:
# 1. Generate age keypair: age-keygen -o master.key
# 2. Store master.key securely (password manager, offline)
# 3. Use sops to encrypt secrets: sops --encrypt --in-place secrets/prod.yaml
# 4. At deploy time, decrypt to tmpfs: sops --decrypt secrets/prod.yaml > /run/secrets/app_secrets
#
# This file contains configurations for all environments.
# Uncomment the appropriate section for your environment.

# =============================================================================
# 1. DEVELOPMENT ENVIRONMENT
# =============================================================================
# Copy this section to .env for local development

APP_NAME="Rust Learning Ground"
DEBUG=true
ENVIRONMENT=development

# Security (auto-generated if not set)
# SECRET_KEY=your-64-char-secret-key-here
# JWT_SECRET_KEY=your-64-char-jwt-secret-key-here

# Database (SQLite for development)
DATABASE_URL=sqlite+aiosqlite:///./data/app.db

# Connection Pooling (ignored for SQLite)
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=2
DB_POOL_RECYCLE=3600
DB_POOL_TIMEOUT=30

# CORS (development only)
CORS_ORIGINS=http://localhost:3000,http://localhost:54321,http://localhost:8000,http://127.0.0.1:3000,http://127.0.0.1:54321,http://127.0.0.1:8000

# Cache (memory fallback in development)
CACHE_ENABLED=true
# REDIS_URL=redis://localhost:6379/0

# Email (console backend for development)
EMAIL_BACKEND=console
EMAIL_FROM=noreply@rustlearning.local

# Monitoring
METRICS_ENABLED=true
LOG_LEVEL=DEBUG

# File Uploads
UPLOAD_DIR=./uploads
MAX_UPLOAD_SIZE_MB=10

# GitHub OAuth (optional)
# GITHUB_CLIENT_ID=your_client_id
# GITHUB_CLIENT_SECRET=your_client_secret

# =============================================================================
# 2. STAGING ENVIRONMENT
# =============================================================================
# Similar to production but with debugging enabled
# Uncomment and configure for staging deployment

# APP_NAME="Rust Learning Ground - Staging"
# DEBUG=false
# ENVIRONMENT=staging

# Security (set these in staging!)
# SECRET_KEY=${SECRET_KEY}
# JWT_SECRET_KEY=${JWT_SECRET_KEY}

# Database (PostgreSQL for staging)
# DATABASE_URL=${DATABASE_URL}

# Connection Pooling
# DB_POOL_SIZE=10
# DB_MAX_OVERFLOW=5
# DB_POOL_RECYCLE=3600
# DB_POOL_TIMEOUT=30

# CORS (staging domains)
# CORS_ORIGINS=${CORS_ORIGINS}

# Cache (Redis recommended)
# CACHE_ENABLED=true
# REDIS_URL=${REDIS_URL}

# Email (console or test SMTP)
# EMAIL_BACKEND=console
# EMAIL_FROM=noreply@staging.rustlearning.com

# Monitoring
# METRICS_ENABLED=true
# LOG_LEVEL=INFO

# File Uploads
# UPLOAD_DIR=./uploads
# MAX_UPLOAD_SIZE_MB=10

# GitHub OAuth
# GITHUB_CLIENT_ID=${GITHUB_CLIENT_ID}
# GITHUB_CLIENT_SECRET=${GITHUB_CLIENT_SECRET}

# Cookie Security
# COOKIE_SECURE=true
# COOKIE_SAMESITE=lax

# =============================================================================
# 3. PRODUCTION ENVIRONMENT
# =============================================================================
# ⚠️  NEVER commit this file with real secrets!
# Use sops/age encryption or environment-specific files
# Uncomment and configure for production deployment

# APP_NAME="Rust Learning Ground"
# DEBUG=false
# ENVIRONMENT=production

# Security (REQUIRED - set these in production!)
# Option 1: File-based secrets (recommended)
# JWT_SECRET_KEY_FILE=/run/secrets/jwt_secret
# SECRET_KEY_FILE=/run/secrets/session_secret
# DATABASE_URL_FILE=/run/secrets/db_url
#
# Option 2: Environment variables
# SECRET_KEY=${SECRET_KEY}
# JWT_SECRET_KEY=${JWT_SECRET_KEY}

# JWT Settings
# ACCESS_TOKEN_EXPIRE_MINUTES=15
# REFRESH_TOKEN_EXPIRE_DAYS=7

# Database (PostgreSQL for production)
# DATABASE_URL=${DATABASE_URL}

# Connection Pooling
# DB_POOL_SIZE=20
# DB_MAX_OVERFLOW=10
# DB_POOL_RECYCLE=3600
# DB_POOL_TIMEOUT=30

# CORS (production domains only)
# CORS_ORIGINS=${CORS_ORIGINS}

# Cache (Redis required for production)
# CACHE_ENABLED=true
# REDIS_URL=${REDIS_URL}

# Email (SMTP or SendGrid for production)
# EMAIL_BACKEND=smtp
# EMAIL_FROM=noreply@rustlearning.com
# EMAIL_FROM_NAME="Rust Learning Ground"
# SMTP_HOST=${SMTP_HOST}
# SMTP_PORT=587
# SMTP_USER=${SMTP_USER}
# SMTP_PASSWORD=${SMTP_PASSWORD}
# SMTP_USE_TLS=true

# Monitoring (required for production)
# METRICS_ENABLED=true
# LOG_LEVEL=INFO
# SENTRY_DSN=${SENTRY_DSN}

# File Uploads
# UPLOAD_DIR=/var/uploads
# MAX_UPLOAD_SIZE_MB=10

# GitHub OAuth (if using GitHub login)
# GITHUB_CLIENT_ID=${GITHUB_CLIENT_ID}
# GITHUB_CLIENT_SECRET=${GITHUB_CLIENT_SECRET}

# Cookie Security
# COOKIE_SECURE=true
# COOKIE_SAMESITE=lax
# COOKIE_DOMAIN=${COOKIE_DOMAIN}

# =============================================================================
# 4. SECURITY SETTINGS (All Environments)
# =============================================================================

# Number of trusted proxies (for X-Forwarded-For)
TRUSTED_PROXIES=0

# Rate Limiting
RATE_LIMIT_REGISTER=3/minute
RATE_LIMIT_LOGIN=5/minute
RATE_LIMIT_REFRESH=20/minute
RATE_LIMIT_API=100/minute

# =============================================================================
# 5. SANDBOX CONFIGURATION
# =============================================================================

# Base directory for ephemeral sandboxes (should be tmpfs-backed in production)
SANDBOX_BASE=/var/sandboxes

# Docker image for sandbox fallback (if nsjail not available)
SANDBOX_DOCKER_IMAGE=rust-sandbox:latest

# =============================================================================
# 6. SOVEREIGN DEPLOYMENT SETTINGS
# =============================================================================

# Master key path for key manager (keep this secure!)
# MASTER_KEY_PATH=/run/secrets/master.key

# AppArmor profile name (if using AppArmor)
# APPARMOR_PROFILE=rust-learner-api

# NixOS/Container settings
# CONTAINER_RUNTIME=podman
